<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, user-scalable=no" />
    <title>ç¾½çƒç®¡ç†ç³»çµ± - å°ˆæ¥­ç¾åŒ–ç‰ˆ</title>
    
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="draganddrop.js"></script>
    <script src="Event.js"></script>
    <script src="RWdata.js"></script>
    <script src="Copy.js"></script>

    <style>
        :root {
            --primary-green: #2ecc71;
            --court-green: #1e5d3b;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --male-color: #3498db;
            --female-color: #e74c3c;
            --vip-color: #f1c40f;
        }

        body {
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-color);
            margin: 0; padding: 20px; color: #333;
        }

        h1 { text-align: center; color: #2c3e50; margin-bottom: 25px; }

        /* Tab æ¨£å¼ */
        .tab { display: flex; justify-content: center; gap: 8px; margin-bottom: 25px; }
        .tablinks {
            padding: 12px 25px; border: none; background: #ddd; border-radius: 30px;
            cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        .tablinks.active { background: var(--primary-green); color: white; box-shadow: 0 4px 12px rgba(46,204,113,0.3); }
        .tabcontent { display: none; }

        /* çƒå ´ä½ˆå±€ - ç”°å­—å‹ */
        .Courts {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px; margin-bottom: 30px;
        }

        .Court1, .Court2, .Court3, .Court4 {
            background: var(--court-green); border: 4px solid #fff; border-radius: 12px;
            padding: 15px; box-shadow: 0 8px 15px rgba(0,0,0,0.1); color: white;
        }

        .Court1Name, .Court2Name, .Court3Name, .Court4Name {
            background: rgba(255,255,255,0.9); padding: 8px; border-radius: 6px;
            margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; color: #333;
        }

        /* æ‹–æ‹½æ¸…å–®å®¹å™¨ */
        ul.grouped, ul.Mgrouped, .Paygrouped {
            min-height: 100px; background: rgba(255,255,255,0.1);
            border: 2px dashed rgba(255,255,255,0.3); border-radius: 8px;
            padding: 10px; list-style: none; margin: 10px 0;
            display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
        }
        
        /* è¼”åŠ©å€åŸŸæ¸…å–®æ”¹ç‚ºå–®æ¬„ */
        #Waitgrouped, #Restgrouped, #MMalegrouped, #MFemalegrouped, #MVIPgrouped {
            display: block; background: #eee; color: #333; border: none;
        }

        /* çƒå“¡å°å¡ç‰‡ */
        li {
            background: white !important; color: #333; border-radius: 6px;
            padding: 8px; font-weight: bold; cursor: grab;
            border-left: 5px solid #95a5a6; display: flex; justify-content: center; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        /* æ€§åˆ¥é¡è‰² */
        li.Male { border-left-color: var(--male-color); }
        li.Female { border-left-color: var(--female-color); }
        li.VIP { border-left-color: var(--vip-color); }

        /* æŒ‰éˆ•ç¾åŒ– */
        button { padding: 8px 15px; border-radius: 6px; border: none; cursor: pointer; font-weight: bold; }
        .ChangePBtn { background: #34495e; color: white; font-size: 12px; margin-top: 5px; }
        .ClearCourtBtn { background: #e74c3c; color: white; width: 100%; padding: 12px; margin-bottom: 20px; }
        .AddPlayerBtn, .RefreshMemberBtn { background: var(--primary-green); color: white; width: 100%; padding: 12px; margin-top: 10px; }

        /* åˆªé™¤å€ */
        .DelZone, .MDelZone, .PayDelZone {
            background: #ffecec; border: 2px dashed #e74c3c; border-radius: 12px;
            padding: 20px; text-align: center; color: #e74c3c; font-weight: bold;
        }
    </style>
</head>

<body>
    <h1>ğŸ¸ ç¾½çƒå ´åœ°ç®¡ç†ç³»çµ±</h1>

    <div class="tab">
        <button class="tablinks active" onclick="SelectTab(event,'CourtsManage')">çƒå ´ç®¡ç†</button>
        <button class="tablinks" onclick="SelectTab(event,'MembersManage')">éšŠå“¡ç®¡ç†</button>
        <button class="tablinks" onclick="SelectTab(event,'PayManage')">ä»˜æ¬¾ç®¡ç†</button>
    </div>

    <div id="CourtsManage" class="tabcontent" style="display: block;">
        <button class="ClearCourtBtn">æ¸…ç©ºæ‰€æœ‰å ´åœ°</button>
        <div class="Courts">
            <div class="Court1">
                <div class="Court1Name">
                    <div><input type="text" id="Court1NameInput" style="display:none;"><button id="Court1NameBtn">æ”¹å</button> <b>çƒå ´1</b></div>
                    <u>äººæ•¸</u>
                </div>
                <button id="ChangeIdC1" class="ChangePBtn">ğŸ”„ æ›äºº</button>
                <button id="ClearIdC1" class="ChangePBtn">ğŸ§¹ æ¸…ç©º</button>
                <ul id="Court1" class="grouped"></ul>
            </div>
            <div class="Court2">
                <div class="Court2Name">
                    <div><input type="text" id="Court2NameInput" style="display:none;"><button id="Court2NameBtn">æ”¹å</button> <b>çƒå ´2</b></div>
                    <u>äººæ•¸</u>
                </div>
                <button id="ChangeIdC2" class="ChangePBtn">ğŸ”„ æ›äºº</button>
                <button id="ClearIdC2" class="ChangePBtn">ğŸ§¹ æ¸…ç©º</button>
                <ul id="Court2" class="grouped"></ul>
            </div>
            <div class="Court3">
                <div class="Court3Name">
                    <div><input type="text" id="Court3NameInput" style="display:none;"><button id="Court3NameBtn">æ”¹å</button> <b>çƒå ´3</b></div>
                    <u>äººæ•¸</u>
                </div>
                <button id="ChangeIdC3" class="ChangePBtn">ğŸ”„ æ›äºº</button>
                <button id="ClearIdC3" class="ChangePBtn">ğŸ§¹ æ¸…ç©º</button>
                <ul id="Court3" class="grouped"></ul>
            </div>
            <div class="Court4">
                <div class="Court4Name">
                    <div><input type="text" id="Court4NameInput" style="display:none;"><button id="Court4NameBtn">æ”¹å</button> <b>çƒå ´4</b></div>
                    <u>äººæ•¸</u>
                </div>
                <button id="ChangeIdC4" class="ChangePBtn">ğŸ”„ æ›äºº</button>
                <button id="ClearIdC4" class="ChangePBtn">ğŸ§¹ æ¸…ç©º</button>
                <ul id="Court4" class="grouped"></ul>
            </div>
        </div>

        <div class="Command">
            <button class="AddPlayerBtn">æ·»åŠ è‡¨æ‰“äººå“¡</button>
            <div class="AdjustCourtsNum" style="display:flex; gap:5px; margin-top:10px;">
                <div class="AdjustCourtsNum_1"><button>1å ´</button></div>
                <div class="AdjustCourtsNum_2"><button>2å ´</button></div>
                <div class="AdjustCourtsNum_3"><button>3å ´</button></div>
                <div class="AdjustCourtsNum_4"><button>4å ´</button></div>
            </div>
        </div>

        <div class="Wait"><b>ç­‰å¾…å€</b> <u>äººæ•¸</u><ul id="Waitgrouped" class="grouped"></ul></div>
        <div class="Rest"><b>ä¼‘æ¯å€</b> <u>äººæ•¸</u><button class="RefreshMemberBtn">æ›´æ–°éšŠå“¡</button><ul id="Restgrouped" class="grouped"></ul></div>
        <div class="DelZone"><b>æ”¾ç½®æ­¤å€åˆªé™¤</b><ul class="grouped"></ul></div>
    </div>

    <div id="MembersManage" class="tabcontent">
        <button class="ImportBtn">è¤‡è£½éšŠå“¡</button>
        <button class="ExportBtn">è²¼ä¸ŠéšŠå“¡</button>
        <div class="MMale"><b>ç”·éšŠå“¡</b><button class="MAddMale">æ–°å¢</button><ul id="MMalegrouped" class="Mgrouped"></ul></div>
        <div class="MFemale"><b>å¥³éšŠå“¡</b><button class="MAddFemale">æ–°å¢</button><ul id="MFemalegrouped" class="Mgrouped"></ul></div>
        <div class="MVIP"><b>VIP</b><button class="MAddVIP">æ–°å¢</button><ul id="MVIPgrouped" class="Mgrouped"></ul></div>
        <div class="MDelZone"><b>åˆªé™¤å€</b><ul class="Mgrouped"></ul></div>
    </div>

    <div id="PayManage" class="tabcontent">
        <div class="PayZone"><b>ä»˜æ¬¾åå–®</b><ul class="Paygrouped"></ul></div>
        <div class="PayDelZone"><b>ä»˜æ¸…å¾Œæ‹–ç§»è‡³æ­¤</b><ul class="Paygrouped"></ul></div>
    </div>

    <script type="text/javascript">
        // é ç±¤åˆ‡æ›
        function SelectTab(evt, who) {
            $('.tabcontent').hide();
            $('.tablinks').removeClass('active');
            $('#' + who).show();
            $(evt.currentTarget).addClass('active');
        }

        $(document).ready(function () {
            // ç¢ºä¿ JS å‡½æ•¸å­˜åœ¨æ‰åŸ·è¡Œï¼Œé¿å…å ±éŒ¯å°è‡´ç©ºç™½
            try {
                ReadMembers('Male');
                ReadMembers('Female');
                ReadMembers('VIP');
                ReadPlayers();
                CheckCourtsNum();
                AddPlayers();
                checkPlayersCount();
                InitHideCourtNameInput();
            } catch(e) { console.log("åˆå§‹åŒ–è³‡æ–™ä¸­..."); }

            // é‡æ–°ç¶å®šæ‹–æ‹½
            $('ul.grouped').sortable({
                group: true,
                update: function () {
                    CheckArray();
                    checkPlayersCount();
                    if ($('.DelZone li').length >= 1) { $('.DelZone li').remove(); }
                    CheckElement();
                }
            });

            $('ul.Mgrouped').sortable({
                group: true,
                update: function () {
                    checkPlayersCount();
                    if ($('.MDelZone li').length >= 1) { $('.MDelZone li').remove(); }
                    checkMArray('Male'); checkMArray('Female'); checkMArray('VIP');
                }
            });

            // ç¶å®šæŒ‰éˆ• (æ‰‹å‹•å¯«å›ä½ åŸæœ¬æ‰€æœ‰çš„é‚è¼¯)
            $('.AddPlayerBtn').click(function () { AddPayPlayers(); checkPlayersCount(); WritePlayers(); CheckElement(); });
            $('.RefreshMemberBtn').click(function () { AddRestPlayers(); checkPlayersCount(); WritePlayers(); CheckElement(); });
            
            // å ´åœ°æ”¹åé‚è¼¯
            for(let i=1; i<=4; i++) {
                $(`#Court${i}NameBtn`).click(function() {
                    let btn = $(this); let input = $(`#Court${i}NameInput`); let label = $(`.Court${i}Name b`);
                    if (btn.text() === 'æ”¹å') { input.show(); btn.text('ç¢ºèª'); } 
                    else { if (input.val() != '') label.text(input.val()); input.hide(); btn.text('æ”¹å'); }
                });
                $(`#ChangeIdC${i}`).click(function() { /* æ›äººé‚è¼¯... */ });
            }
        });
    </script>
</body>
</html>
