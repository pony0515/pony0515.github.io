<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes" />
    <title>Courts Management</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../draganddrop.css">
    <link rel="stylesheet" href="http://www.jqueryscript.net/css/jquerysctipttop.css">
    <!-- <link rel="stylesheet" href="https://bootswatch.com/flatly/bootstrap.min.css"> -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="../draganddrop.js"></script>
    <script src="../Event.js"></script>

    <h1>晨羽球場管理</h1>
    <script>
        $(document).ready(function () {
            // init area
            CheckCourtsNum();
            //ul.grouped 可排序 且 群組化
            $('ul.grouped').sortable({
                group: true,
                handle: '.sortHandle',
                update: function () {
                    CheckArray();
                    ///檢查場地上人員 < 4
                    for (let index = 1; index <= 4; index++) {
                        var n = $('.Court' + (String)(index) + ' li').length;
                        if (n > 4) {
                            TargetError('.Court' + (String)(index));
                        } else {
                            TargetOK('.Court' + (String)(index));
                        }
                    }
                    ///刪除人員
                    var n_del = $('.DelZone li').length;
                    if (n_del >= 1) {
                        $('.DelZone li').remove();
                    }
                    ///等待區排列 四個一排
                    // var n_wait = $('.Wait li').length;
                    // if (WaitNum != n_wait) {
                    //     WaitNum = n_wait;
                    //     if (n_wait % 4 === 0) {
                    //         SetWaitting();
                    //     }
                    // }
                }
            });

            ///Command Btn Event
            ///添加人員
            $('.AddPlayerBtn').click(function () {
                AddPlayers();
            });
            ///換人 按紐
            $('#ChangeIdC1').click(function () {
                for (let index = 0; index < Court1Array.length; index++) {
                    WaitArray.push(Court1Array[index]); ///等待區添加人員
                }
                Court1Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court1Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            $('#ChangeIdC2').click(function () {
                for (let index = 0; index < Court2Array.length; index++) {
                    WaitArray.push(Court2Array[index]); ///等待區添加人員
                }
                Court2Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court2Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            $('#ChangeIdC3').click(function () {
                for (let index = 0; index < Court3Array.length; index++) {
                    WaitArray.push(Court3Array[index]); ///等待區添加人員
                }
                Court3Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court3Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            $('#ChangeIdC4').click(function () {
                for (let index = 0; index < Court4Array.length; index++) {
                    WaitArray.push(Court4Array[index]); ///等待區添加人員
                }
                Court4Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court4Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            ///清空場地          
            $('#ClearIdC1').click(function () {
                for (let index = 0; index < Court1Array.length; index++) {
                    WaitArray.push(Court1Array[index]); ///等待區添加人員
                }
                Court1Array.length = 0; ///清空
                CheckElement();
            });
            $('#ClearIdC2').click(function () {
                for (let index = 0; index < Court2Array.length; index++) {
                    WaitArray.push(Court2Array[index]); ///等待區添加人員
                }
                Court2Array.length = 0; ///清空
                CheckElement();
            });
            $('#ClearIdC3').click(function () {
                for (let index = 0; index < Court3Array.length; index++) {
                    WaitArray.push(Court3Array[index]); ///等待區添加人員
                }
                Court3Array.length = 0; ///清空
                CheckElement();
            });
            $('#ClearIdC4').click(function () {
                for (let index = 0; index < Court4Array.length; index++) {
                    WaitArray.push(Court4Array[index]); ///等待區添加人員
                }
                Court4Array.length = 0; ///清空
                CheckElement();
            });
            ///場地數量 按紐
            $('.AdjustCourtsNum_1 button').click(function () {
                CourtsNum = 1;
                CheckCourtsNum();
            });
            $('.AdjustCourtsNum_2 button').click(function () {
                CourtsNum = 2;
                CheckCourtsNum();
            });
            $('.AdjustCourtsNum_3 button').click(function () {
                CourtsNum = 3;
                CheckCourtsNum();
            });
            $('.AdjustCourtsNum_4 button').click(function () {
                CourtsNum = 4;
                CheckCourtsNum();
            });
            ///新創立元素的事件 必須用此方式添加.
            ///人員改名
            for (let index = 1; index <= 50; index++) {
                $('body').on('click', '.p' + (String)(index) + ' button', function () {

                    if ($('.p' + (String)(index) + ' button').text() === '改名') {
                        $('#InputName' + (String)(index)).show();
                        $('.p' + (String)(index) + ' button').text('確認');
                    } else if ($('.p' + (String)(index) + ' button').text() === '確認') {
                        console.log($('#InputName' + (String)(index)).val());
                        $('.p' + +(String)(index) + ' span').text($('#InputName' + (String)(index))
                            .val());
                        $('#InputName' + +(String)(index)).hide();
                        $('.p' + (String)(index) + ' button').text('改名');
                        CheckArray();
                    }
                })
            }
        });
    </script>
</head>

<body>
    <h3>球場狀態</h3>
    <div class="Courts">
        <div class="Court1">
            <h4>球場1</h4>
            <button id="ChangeIdC1" class="ChangePBtn">換人</button>
            <button id="ClearIdC1" class="ChangePBtn">清空</button>
            <ul id="Court1" class="grouped">
            </ul>
        </div>

        <div class="Court2">
            <h4>球場2</h4>
            <button id="ChangeIdC2" class="ChangePBtn">換人</button>
            <button id="ClearIdC2" class="ChangePBtn">清空</button>
            <ul id="Court2" class="grouped">
            </ul>
        </div>

        <div class="Court3">

            <h4>球場3</h4>
            <button id="ChangeIdC3" class="ChangePBtn">換人</button>
            <button id="ClearIdC3" class="ChangePBtn">清空</button>
            <ul id="Court3" class="grouped">
            </ul>
        </div>

        <div class="Court4">

            <h4>球場4</h4>
            <button id="ChangeIdC4" class="ChangePBtn">換人</button>
            <button id="ClearIdC4" class="ChangePBtn">清空</button>
            <ul id="Court4" class="grouped">
            </ul>
        </div>
    </div>

    <div class="Command">
        <div>
            <button class="AddPlayerBtn">添加人員</button>
        </div>
        <div class="AdjustCourtsNum">
            <div class="AdjustCourtsNum_1">
                <button>1個場地</button>
            </div>
            <div class="AdjustCourtsNum_2">
                <button>2個場地</button>
            </div>
            <div class="AdjustCourtsNum_3">
                <button>3個場地</button>
            </div>
            <div class="AdjustCourtsNum_4">
                <button>4個場地</button>
            </div>
        </div>
    </div>

    <div class="Wait">
        <h3>等待區狀態</h3>
        <ul id="Waitgrouped" class="grouped">
        </ul>
    </div>

    <div class="DelZone">
        <h3>放置此區後刪除</h3>
        <ul id="Delgrouped" class="grouped">
        </ul>
    </div>
</body>

</html>
