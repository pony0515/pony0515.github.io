<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=no" />
    <title>羽球管理</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="draganddrop.css">
    <link rel="stylesheet" href="http://www.jqueryscript.net/css/jquerysctipttop.css">
    <!-- <link rel="stylesheet" href="https://bootswatch.com/flatly/bootstrap.min.css"> -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="draganddrop.js"></script>
    <script src="Event.js"></script>
    <script src="RWdata.js"></script>

    <h1>球場管理</h1>

    <script type="text/javascript">
        $(document).ready(function () {
            // init area
            CheckCourtsNum();
            ReadMembers('Male');
            ReadMembers('Female');
            ReadMembers('VIP');
            checkPlayersCount();
            InitHideCourtNameInput();
            //ManualDel();
            ///球場管理畫面
            //ul.grouped 可排序 且 群組化
            $('ul.grouped').sortable({
                group: true,
                handle: '.sortHandle',
                update: function () {
                    CheckArray();
                    checkPlayersCount();
                    ///檢查場地上人員 < 4
                    for (let index = 1; index <= 4; index++) {
                        var n = $('.Court' + (String)(index) + ' li').length;
                        if (n > 4) {
                            TargetError('.Court' + (String)(index));
                        } else {
                            TargetOK('.Court' + (String)(index));
                        }
                    }
                    ///刪除人員
                    var n_del = $('.DelZone li').length;
                    if (n_del >= 1) {
                        $('.DelZone li').remove();
                    }
                }
            });

            ///Command Btn Event
            ///添加臨打人員
            $('.AddPlayerBtn').click(function () {
                AddPlayers();
                checkPlayersCount();
            });
            ///改場地名稱
            $('#Court1NameBtn').click(function () {
                if ($('#Court1NameBtn').text() === '改名') {
                    $('#Court1NameInput').show();
                    $('#Court1NameBtn').text('確認');
                } else if ($('#Court1NameBtn').text() === '確認') {
                    newName = $('#Court1NameInput').val();
                    if (newName != '') {
                        $('.Court1Name b').text(newName);
                    }
                    $('#Court1NameInput').hide();
                    $('#Court1NameBtn').text('改名');
                }
            });
            $('#Court2NameBtn').click(function () {
                if ($('#Court2NameBtn').text() === '改名') {
                    $('#Court2NameInput').show();
                    $('#Court2NameBtn').text('確認');
                } else if ($('#Court2NameBtn').text() === '確認') {
                    newName = $('#Court2NameInput').val();
                    if (newName != '') {
                        $('.Court2Name b').text(newName);
                    }
                    $('#Court2NameInput').hide();
                    $('#Court2NameBtn').text('改名');
                }
            });
            $('#Court3NameBtn').click(function () {
                if ($('#Court3NameBtn').text() === '改名') {
                    $('#Court3NameInput').show();
                    $('#Court3NameBtn').text('確認');
                } else if ($('#Court3NameBtn').text() === '確認') {
                    newName = $('#Court3NameInput').val();
                    if (newName != '') {
                        $('.Court3Name b').text(newName);
                    }
                    $('#Court3NameInput').hide();
                    $('#Court3NameBtn').text('改名');
                }
            });
            $('#Court4NameBtn').click(function () {
                if ($('#Court4NameBtn').text() === '改名') {
                    $('#Court4NameInput').show();
                    $('#Court4NameBtn').text('確認');
                } else if ($('#Court4NameBtn').text() === '確認') {
                    newName = $('#Court4NameInput').val();
                    if (newName != '') {
                        $('.Court4Name b').text(newName);
                    }
                    $('#Court4NameInput').hide();
                    $('#Court4NameBtn').text('改名');
                }
            });
            ///換人 按紐
            $('#ChangeIdC1').click(function () {
                Court1Array = Court1Array.sort(shuffle);
                for (let index = 0; index < Court1Array.length; index++) {
                    WaitArray.push(Court1Array[index]); ///等待區添加人員
                }
                Court1Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court1Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            $('#ChangeIdC2').click(function () {
                Court2Array = Court2Array.sort(shuffle);
                for (let index = 0; index < Court2Array.length; index++) {
                    WaitArray.push(Court2Array[index]); ///等待區添加人員
                }
                Court2Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court2Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            $('#ChangeIdC3').click(function () {
                Court3Array = Court3Array.sort(shuffle);
                for (let index = 0; index < Court3Array.length; index++) {
                    WaitArray.push(Court3Array[index]); ///等待區添加人員
                }
                Court3Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court3Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            $('#ChangeIdC4').click(function () {
                Court4Array = Court4Array.sort(shuffle);
                for (let index = 0; index < Court4Array.length; index++) {
                    WaitArray.push(Court4Array[index]); ///等待區添加人員
                }
                Court4Array.length = 0; ///清空
                for (let index = 0; index < 4; index++) {
                    if (WaitArray.length != 0) {
                        Court4Array.push(WaitArray.shift()); ///將等待區人員移自Court
                    }
                }
                CheckElement();
            });
            ///清空場地          
            $('#ClearIdC1').click(function () {
                Court1Array = Court1Array.sort(shuffle);
                for (let index = 0; index < Court1Array.length; index++) {
                    WaitArray.push(Court1Array[index]); ///等待區添加人員
                }
                Court1Array.length = 0; ///清空
                CheckElement();
            });
            $('#ClearIdC2').click(function () {
                Court2Array = Court2Array.sort(shuffle);
                for (let index = 0; index < Court2Array.length; index++) {
                    WaitArray.push(Court2Array[index]); ///等待區添加人員
                }
                Court2Array.length = 0; ///清空
                CheckElement();
            });
            $('#ClearIdC3').click(function () {
                Court3Array = Court3Array.sort(shuffle);
                for (let index = 0; index < Court3Array.length; index++) {
                    WaitArray.push(Court3Array[index]); ///等待區添加人員
                }
                Court3Array.length = 0; ///清空
                CheckElement();
            });
            $('#ClearIdC4').click(function () {
                Court4Array = Court4Array.sort(shuffle);
                for (let index = 0; index < Court4Array.length; index++) {
                    WaitArray.push(Court4Array[index]); ///等待區添加人員
                }
                Court4Array.length = 0; ///清空
                CheckElement();
            });
            ///場地數量 按紐
            $('.AdjustCourtsNum_1 button').click(function () {
                CourtsNum = 1;
                CheckCourtsNum();
            });
            $('.AdjustCourtsNum_2 button').click(function () {
                CourtsNum = 2;
                CheckCourtsNum();
            });
            $('.AdjustCourtsNum_3 button').click(function () {
                CourtsNum = 3;
                CheckCourtsNum();
            });
            $('.AdjustCourtsNum_4 button').click(function () {
                CourtsNum = 4;
                CheckCourtsNum();
            });

            ////隊員管理畫面
            //ul.Mgrouped 可排序 且 群組化
            $('ul.Mgrouped').sortable({
                group: true,
                handle: '.sortHandle',
                update: function () {
                    checkPlayersCount();
                    ///刪除人員
                    var n_del = $('.MDelZone li').length;
                    if (n_del >= 1) {
                        $('.MDelZone li').remove();
                    }
                    ///儲存
                    checkMArray('Male');
                    checkMArray('Female');
                    checkMArray('VIP');

                }
            });
            ////新增隊員
            $('.MAddmale').click(function () {
                AddMember('Male', '男隊員');
                checkPlayersCount();
            });
            $('.MAddfemale').click(function () {
                AddMember('Female', '女隊員');
                checkPlayersCount();
            });
            $('.MAddVIP').click(function () {
                AddMember('VIP', 'VIP');
                checkPlayersCount();
            });
        });
    </script>
</head>

<body>
    <div class="tab">
        <button class="tablinks" onclick="SelectTab(event,'CourtsManage')">球場管理</button>
        <button class="tablinks" onclick="SelectTab(event,'MembersManage')">隊員管理</button>
    </div>

    <div id="CourtsManage" class="tabcontent">
        <!-- <div id="CourtsManage"> -->
        <h3>球場狀態</h3>
        <div class="Courts">
            <div class="Court1">
                <div class="Court1Name">
                    <input type="text" id="Court1NameInput">
                    <button id="Court1NameBtn">改名</button>
                    <b>球場1</b>
                    <u>人數</u>
                </div>
                <button id="ChangeIdC1" class="ChangePBtn">換人</button>
                <button id="ClearIdC1" class="ChangePBtn">清空</button>
                <ul id="Court1" class="grouped">
                    <div class="empty"></div>
                </ul>
            </div>

            <div class="Court2">
                <div class="Court2Name">
                    <input type="text" id="Court2NameInput">
                    <button id="Court2NameBtn">改名</button>
                    <b>球場2</b>
                    <u>人數</u>
                </div>
                <button id="ChangeIdC2" class="ChangePBtn">換人</button>
                <button id="ClearIdC2" class="ChangePBtn">清空</button>
                <ul id="Court2" class="grouped">
                    <div class="empty"></div>
                </ul>
            </div>

            <div class="Court3">
                <div class="Court3Name">
                    <input type="text" id="Court3NameInput">
                    <button id="Court3NameBtn">改名</button>
                    <b>球場3</b>
                    <u>人數</u>
                </div>
                <button id="ChangeIdC3" class="ChangePBtn">換人</button>
                <button id="ClearIdC3" class="ChangePBtn">清空</button>
                <ul id="Court3" class="grouped">
                    <div class="empty"></div>
                </ul>
            </div>

            <div class="Court4">
                <div class="Court4Name">
                    <input type="text" id="Court4NameInput">
                    <button id="Court4NameBtn">改名</button>
                    <b>球場4</b>
                    <u>人數</u>
                </div>
                <button id="ChangeIdC4" class="ChangePBtn">換人</button>
                <button id="ClearIdC4" class="ChangePBtn">清空</button>
                <ul id="Court4" class="grouped">
                    <div class="empty"></div>
                </ul>
            </div>
        </div>

        <div class="Command">
            <div>
                <button class="AddPlayerBtn">添加臨打人員</button>
            </div>
            <div class="AdjustCourtsNum">
                <div class="AdjustCourtsNum_1">
                    <button>1個場地</button>
                </div>
                <div class="AdjustCourtsNum_2">
                    <button>2個場地</button>
                </div>
                <div class="AdjustCourtsNum_3">
                    <button>3個場地</button>
                </div>
                <div class="AdjustCourtsNum_4">
                    <button>4個場地</button>
                </div>
            </div>
        </div>

        <div class="Wait">
            <b>等待區狀態</b>
            <u>人數</u>
            <ul id="Waitgrouped" class="grouped">
                <div class="empty"></div>
            </ul>
        </div>

        <div class="Rest">
            <b>休息區(不會上場)</b>
            <u>人數</u>
            <ul id="Restgrouped" class="grouped">
                <div class="empty"></div>
            </ul>
        </div>

        <div class="DelZone">
            <b>放置此區後刪除</b>
            <ul id="Delgrouped" class="grouped">
                <div class="empty"></div>
            </ul>
        </div>
    </div>

    <div id="MembersManage" class="tabcontent">
        <!-- <div id="MembersManage"></div> -->
        <h3>隊員狀態</h3>
        <div class="Mmale">
            <b>男隊員</b>
            <u>人數</u>
            <div>
                <button class="MAddmale">新增</button>
            </div>
            <ul id="Mmalegrouped" class="Mgrouped">
                <div class="empty"></div>
            </ul>
        </div>
        <div class="Mfemale">
            <b>女隊員</b>
            <u>人數</u>
            <div>
                <button class="MAddfemale">新增</button>
            </div>
            <ul id="Mfemalegrouped" class="Mgrouped">
                <div class="empty"></div>
            </ul>
        </div>
        <div class="MVIP">
            <b>VIP隊員</b>
            <u>人數</u>
            <div>
                <button class="MAddVIP">新增</button>
            </div>
            <ul id="MVIPgrouped" class="Mgrouped">
                <div class="empty"></div>
            </ul>
        </div>
        <div class="MDelZone">
            <b>放置此區後刪除</b>
            <ul id="MDelgrouped" class="Mgrouped">
                <div class="empty"></div>
            </ul>
        </div>
    </div>

    <script>
        function SelectTab(evt, who) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName('tabcontent');
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = 'none';
            }
            tablinks = document.getElementsByClassName('tablinks');
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(' active', '');
            }
            document.getElementById(who).style.display = 'block';
            evt.currentTarget.className += ' active';
        }
    </script>
</body>

</html>